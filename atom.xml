<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[lab2023 - internet teknolojileri]]></title>
  <link href="http://lab2023.github.com/atom.xml" rel="self"/>
  <link href="http://lab2023.github.com/"/>
  <updated>2013-02-24T13:26:13+02:00</updated>
  <id>http://lab2023.github.com/</id>
  <author>
    <name><![CDATA[lab2023]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Octopress nasıl kullanılır?]]></title>
    <link href="http://lab2023.github.com/blog/2013/02/24/octopress-nasil-kullanilir/"/>
    <updated>2013-02-24T13:13:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2013/02/24/octopress-nasil-kullanilir</id>
    <content type="html"><![CDATA[<p>Belli bir süre Octopress&#8217;i mercek altına alacağız.</p>

<!-- more -->


<h2>Yeni post yazma</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake new_post["title"]</span></code></pre></td></tr></table></div></figure>


<p><code>source</code> brancheında <code>_post</code> dizininde yeni dosyayı görüyoruz. Buradan author, categories&#8217;i düzenliyoruz.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>---
</span><span class='line'>layout: post
</span><span class='line'>title: "Octopress nasıl kullanılır?"
</span><span class='line'>date: 2013-02-24 13:13
</span><span class='line'>comments: true
</span><span class='line'>author: Onur Özgür ÖZKAN
</span><span class='line'>categories: octopress
</span><span class='line'>---</span></code></pre></td></tr></table></div></figure>


<p>Sonra markdown stadanartında makalemizi yazıyoruz.</p>

<h2>Generate ve Preview işlemleri</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake generate   # Generates posts and pages into the public directory
</span><span class='line'>rake watch      # Watches source/ and sass/ for changes and regenerates
</span><span class='line'>rake preview    # Watches, and mounts a webserver at http://localhost:4000</span></code></pre></td></tr></table></div></figure>


<h2>Deploy etmeyi unutmayın</h2>

<p>Publish için</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake generate
</span><span class='line'>rake deploy</span></code></pre></td></tr></table></div></figure>


<p>Source kodlarıda source branchına gönderiyoruz.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git add .
</span><span class='line'>git commit -m 'your message'
</span><span class='line'>git push origin source</span></code></pre></td></tr></table></div></figure>


<p>Şimdilik bu kadar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails Projelerinde JQuery Autocomplete Kullanımı]]></title>
    <link href="http://lab2023.github.com/blog/2013/01/27/rails-projelerinde-jquery-autocomplete-kullanimi/"/>
    <updated>2013-01-27T14:43:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2013/01/27/rails-projelerinde-jquery-autocomplete-kullanimi</id>
    <content type="html"><![CDATA[<p>Bunun için <a href="http://jqueryui.com/">jQuery UI</a> kütüphanesine ihtiyacımız var. Kütüphaneyi projemize eklemek için <a href="https://github.com/joliss/jquery-ui-rails">jquery-ui-rails</a> gemini kulanacağız. Gemfile dosyasına gemi <code>gem "jquery-ui-rails"</code> ekledikten sonra <code>bundle install</code> komutunu çalıştıralım.
Javascript kütüphanesini çağırmak için <code>application.js</code> dosyasına</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">//= require jquery.ui.autocomplete</span>
</span></code></pre></td></tr></table></div></figure>


<p>Css kütüphanesini çağırmak için <code>application.css.scss</code> dosyasına</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="c">/*</span>
</span><span class='line'><span class="c">*= require jquery.ui.autocomplete</span>
</span><span class='line'><span class="c">*/</span>
</span></code></pre></td></tr></table></div></figure>


<p>satırlarını ekleyelim.</p>

<!-- more -->


<p>Şimdi autocomplete yapılacak olan alanı oluşturalım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name_or_country_name_cont</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s1">&#39;search_zones&#39;</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;search-query&#39;</span><span class="p">,</span>  <span class="ss">:placeholder</span> <span class="o">=&gt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;search&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="ss">data</span><span class="p">:</span> <span class="p">{</span><span class="n">autocomplete_source</span><span class="p">:</span> <span class="n">auto_admins_zones_path</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>data</code> autocomplete için arama yapacağı yol.</p>

<p>Şimdide bu alana autocomplete özelliği verelim.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">//application.js</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.search-query&#39;</span><span class="p">).</span><span class="nx">autocomplete</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">source</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.search-query&#39;</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;autocomplete-source&#39;</span><span class="p">),</span>
</span><span class='line'>        <span class="nx">messages</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">noResults</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">results</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>.search-query</code> clas&#8217; ına sahip alanlara autocomplete özelliği eklemiş olduk. <code>source</code> parametresi ise autocomplete için verilerin yolu. <code>messages</code> parametresi ise ismindende anlaşılacağı gibi mesaj ayarları için. &#8220;1 sonuç bulundu, Hiç sonuç bulunamadı &#8230;&#8221; gibi. Burada hiç bir mesaj döndürmüyor.</p>

<p>Şimdi autocomplete için <code>json</code> veri döndürecek metodu yazalım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">auto</span>
</span><span class='line'>    <span class="n">search</span> <span class="o">=</span> <span class="no">Zone</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="ss">:name_or_country_name_start</span> <span class="o">=&gt;</span> <span class="n">params</span><span class="o">[</span><span class="ss">:term</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="n">zones</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="ss">:distinct</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span class='line'>    <span class="n">render</span> <span class="ss">:json</span> <span class="o">=&gt;</span> <span class="n">zones</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span><span class="o">|</span><span class="nb">p</span><span class="o">|</span> <span class="no">Hash</span><span class="o">[</span><span class="nb">id</span><span class="p">:</span> <span class="nb">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="ss">label</span><span class="p">:</span> <span class="nb">p</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="nb">p</span><span class="o">.</span><span class="n">name</span><span class="o">]</span><span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Arama işlemlerinde <a href="https://github.com/ernie/ransack">ransack</a> kullanıyorum kafanız karışmasın. Automoplete aranılan veriyi <code>term</code> parametresi olarak gönderiyor.</p>

<p><img src="https://dl.dropbox.com/u/44821222/autocomplete-1.png" alt="Autocomplete" />
<img src="https://dl.dropbox.com/u/44821222/autocomplete-2.png" alt="Autocomplete" />
<img src="https://dl.dropbox.com/u/44821222/autocomplete-3.png" alt="Autocomplete" /></p>

<p>Autocomplete için daha detaylı dökümana <a href="http://jqueryui.com/autocomplete/#combobox">buradan</a> ulaşabilirsiniz.</p>

<p>İyi çalışmalar dilerim.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby On Rails Breadcrumbs(Ekmek kırıntısı)]]></title>
    <link href="http://lab2023.github.com/blog/2013/01/25/ruby-on-rails-breadcrumbs-ekmek-kirintisi/"/>
    <updated>2013-01-25T13:40:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2013/01/25/ruby-on-rails-breadcrumbs-ekmek-kirintisi</id>
    <content type="html"><![CDATA[<p>Breadcrumb için <a href="http://www.simonecarletti.com/code/breadcrumbs_on_rails/">breadcrumbs_on_rails</a> gemini kullanıyoruz. Gemfile&#8217; a <code>gem 'breadcrumbs_on_rails'</code> ekledikten sonra <code>bundle:install</code> komutunu çalıştırarak gemi kuralım. Controller&#8217; da <code>add_breadcrumb</code> metodunu çağırarak breadcrumb ekleyebiliyoruz. View katmanında ise <code>render_breadcrumbs</code> helper&#8217; ı kullanıyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Admins</span><span class="o">::</span><span class="no">ApplicationController</span> <span class="o">&lt;</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">add_breadcrumb</span> <span class="s2">&quot;Dashboard&quot;</span><span class="p">,</span> <span class="ss">:admins_dashboard_index_path</span> <span class="c1">#I18n.t(&#39;nav.dashboard&#39;)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Admins</span><span class="o">::</span><span class="no">CountriesController</span> <span class="o">&lt;</span> <span class="ss">Admins</span><span class="p">:</span><span class="ss">:ApplicationController</span>
</span><span class='line'>  <span class="n">add_breadcrumb</span> <span class="s2">&quot;Countries&quot;</span><span class="p">,</span> <span class="ss">:admins_countries_path</span> <span class="c1">#I18n.t(&#39;nav.countries&#39;)</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@search</span> <span class="o">=</span> <span class="no">Country</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:q</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@countries</span> <span class="o">=</span> <span class="vi">@search</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="ss">:distinct</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="ss">:page</span> <span class="o">=&gt;</span> <span class="n">params</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="n">respond_with</span><span class="p">(</span><span class="vi">@countries</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">new</span>
</span><span class='line'>    <span class="vi">@country</span> <span class="o">=</span> <span class="no">Country</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">add_breadcrumb</span> <span class="s2">&quot;New&quot;</span><span class="p">,</span> <span class="n">new_admins_country_path</span>
</span><span class='line'>    <span class="n">respond_with</span><span class="p">(</span><span class="vi">@country</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">edit</span>
</span><span class='line'>    <span class="n">add_breadcrumb</span> <span class="s2">&quot;Edit&quot;</span><span class="p">,</span> <span class="n">edit_admins_country_path</span>
</span><span class='line'>    <span class="vi">@country</span> <span class="o">=</span> <span class="no">Country</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="https://dl.dropbox.com/u/44821222/breadcrumb-1.png" alt="Braeadcrumb-1" />
<img src="https://dl.dropbox.com/u/44821222/breadcrumb-2.png" alt="Braeadcrumb-1" />
<img src="https://dl.dropbox.com/u/44821222/breadcrumb-3.png" alt="Braeadcrumb-1" /></p>

<p>Dilerseniz <a href="http://www.simonecarletti.com/code/breadcrumbs_on_rails/">Dökümantasyon</a> sayfasının ziyaret edebilirsiniz.</p>

<p>İyi çalışmalar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[globalize3 ile Çoklu Dil Desteği (I18n)]]></title>
    <link href="http://lab2023.github.com/blog/2013/01/24/globalize3-ile-coklu-dil-destegi-i18n/"/>
    <updated>2013-01-24T14:29:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2013/01/24/globalize3-ile-coklu-dil-destegi-i18n</id>
    <content type="html"><![CDATA[<p>Model katmanına I18n desteği eklemek için <a href="https://github.com/svenfuchs/globalize3">globalize3</a> gemini kullanıyoruz.</p>

<p>Gemfile&#8217; a <code>gem 'globalize3'</code> ekleyip <code>bundle install</code> ile gemi kuralım.</p>

<p>Modelde I18n desteği eklenilecek fieldları belirtiyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Country</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">attr_accessible</span> <span class="ss">:name</span>
</span><span class='line'>  <span class="n">translates</span> <span class="ss">:name</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<p>Daha sonra migrationda translates tablosunu oluşturacak kodu ekliyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">CreateCountries</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Migration</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">change</span>
</span><span class='line'>    <span class="n">create_table</span> <span class="ss">:countries</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">timestamps</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="no">Country</span><span class="o">.</span><span class="n">create_translation_table!</span> <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="ss">:string</span>
</span><span class='line'>    <span class="no">Country</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="nb">name</span><span class="p">:</span> <span class="s2">&quot;Turkey&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>rake db:migrate</code> komutunu çalıştıralım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;&gt;</span> <span class="no">I18n</span><span class="o">.</span><span class="n">locale</span>
</span><span class='line'><span class="ss">:en</span>
</span><span class='line'><span class="o">&gt;&gt;</span> <span class="no">Country</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'><span class="s2">&quot;TURKEY&quot;</span>
</span><span class='line'><span class="o">&gt;&gt;</span> <span class="no">I18n</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="ss">:tr</span>
</span><span class='line'><span class="ss">:tr</span>
</span><span class='line'><span class="o">&gt;&gt;</span> <span class="no">Country</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'><span class="kp">nil</span>
</span><span class='line'><span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="no">Country</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'><span class="c1">#&lt;Country id: 1, name: nil, created_at: &quot;2013-01-24 08:20:59&quot;, updated_at: &quot;2013-01-24 11:09:31&quot;&gt;</span>
</span><span class='line'><span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Türkiye&quot;</span>
</span><span class='line'><span class="s2">&quot;Türkiye&quot;</span>
</span><span class='line'><span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">save</span>
</span><span class='line'><span class="kp">true</span>
</span><span class='line'><span class="o">&gt;&gt;</span> <span class="no">I18n</span><span class="o">.</span><span class="n">locale</span>
</span><span class='line'><span class="ss">:tr</span>
</span><span class='line'><span class="o">&gt;&gt;</span> <span class="no">Country</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'><span class="s2">&quot;Türkiye&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Örnekte locale <code>:tr</code> iken bir veri kaydedilmediğinden <code>nil</code> sonucu döndü. Eğer <code>nil</code> yerine default locale değerinin dönmesini istersek <code>application.rb</code> dosyasına aşağıdaki satırı ekleyelim.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">i18n</span><span class="o">.</span><span class="n">fallbacks</span> <span class="o">=</span> <span class="kp">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>İyi çalışmalar dilerim.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PostgreSQL Yedek Alma ve Geri Yükleme]]></title>
    <link href="http://lab2023.github.com/blog/2013/01/21/postgresql-yedek-alma-ve-geri-yukleme/"/>
    <updated>2013-01-21T18:38:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2013/01/21/postgresql-yedek-alma-ve-geri-yukleme</id>
    <content type="html"><![CDATA[<h4><code>pg_dump</code></h4>

<p><code>pg_dump veritabaniadi -f dosyaadi.dump</code></p>

<ul>
<li>1 vt yedeği alır.</li>
<li>Öntanımlı olarak düz metin yedek alır.</li>
<li><p>Yedeği sıkıştırabilir.
<code>pg_dump -Fc veritabaniadi -f dosyaadi.dump</code></p></li>
<li><p>Global veriyi almaz. (User, tablespace)</p></li>
<li>Sıkıştırılmış yedeği tablo bazında açma imkanı. Sadece sıkıştırılmış formattayken.</li>
<li>Sadece istenilen tabloların yedeğini alma
<code>-t "satislar."</code> satislar tablosunun yedeğini al. <code>-T satislar</code> satislar dışındaki tabloların yedeğini al.</li>
<li>Sadece schema yı yedek alma
<code>-s</code></li>
<li>Sadece dataları almak.
<code>-a</code></li>
</ul>


<h4><code>pg_dumpall</code></h4>

<ul>
<li>Tüm veritabanlarının yedeğini tek dosyaya alır.</li>
<li>Sadece düz metin olarak yedek alır.(.sql)</li>
<li>Bir tablo veya database açılamaz. Yedekler olduğu gibi geri yüklenir.</li>
<li>Global bilgileri ayrı olarak yedekleyebilirsiniz.
<code>pg_dumpall -g -f dosyaadi.dump</code></li>
<li>Sadece schema yı yedek alma
<code>-s</code></li>
<li>Sadece dataları almak.
<code>-a</code></li>
</ul>


<p><code>pg_dump</code> &amp; <code>pg_dumpall</code></p>

<ul>
<li><code>INSERT</code> li yedek almaz. Bunun yerine <code>COPY</code> kullanılır. Sebebi her <code>INSERT</code> işleminin <code>TRANSACTION</code> içerisinde olmasıdır.</li>
</ul>


<p>Kesinlikle <code>pg_dump</code> kullanın, yedeği sıkıştırın, global bilgileri <code>pg_dumpall</code> ile alın. Geri yüklerken önce global veriler yüklenir.</p>

<h3><code>pg_restore</code></h3>

<ul>
<li><code>pg_restore -d veritabaniadi yedek.dump -j 4</code></li>
<li>Sadece sıkıştırlmış verileri geri yükler.</li>
<li><code>-j</code> parelel oturum.</li>
</ul>


<p><a href="http://ab.org.tr/ab13/postgresql.html">ab2013 postgresql</a> eğitim notlarından.</p>

<p>İyi çalışmalar.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby On Rails Application Template Oluşturma]]></title>
    <link href="http://lab2023.github.com/blog/2012/12/23/ruby-on-rails-application-template-olusturma/"/>
    <updated>2012-12-23T17:00:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2012/12/23/ruby-on-rails-application-template-olusturma</id>
    <content type="html"><![CDATA[<h3>Template nedir ?</h3>

<p>Yeni bir <code>rails</code> uygulaması oluştururken genel görevleri otomatikleştirmek için yardımcı <code>ruby</code> script. Örneğin her <code>rails</code> projesinde <code>devise</code> gemini kullanıyorsak bunu her seferinde eklemek yerine template&#8217; e ekleyip aynı işlemleri tekrarlamaktan kurtulabiliriz.</p>

<h3>Template Oluşturma</h3>

<p>Template oluşturmak için ne bir <code>generator</code> nede bir <code>gem</code> kullancağız. İçerisine bazı metodlar yazabileceğimiz bir <code>ruby</code> dosyası yeterli :)</p>

<!-- more -->


<h3>Template Kullanımı</h3>

<p>Yeni bir uygulama oluştururken <code>-m</code> parametresinden sonra template yolunu yazıyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rails new blog -m ~/template.rb
</span><span class='line'><span class="nv">$ </span>rails new APP_NAME -m https://raw.github.com/lab2023/rails-template/master/rails_template.rb
</span></code></pre></td></tr></table></div></figure>


<p>Yada <code>rails:tempalte</code> rake&#8217; ini kullanabiliriz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rake rails:template <span class="nv">LOCATION</span><span class="o">=</span>~/template.rb
</span><span class='line'><span class="nv">$ </span>rake rails:template <span class="nv">LOCATION</span><span class="o">=</span>http://example.com/template.rb
</span></code></pre></td></tr></table></div></figure>


<h3>Template metodları:</h3>

<h4>gem(name, options = {})</h4>

<p><code>gem</code> metodu Gemfile dosyasın gem eklenmesini sağlıyor.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;will_paginate&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;bootstrap-will_paginate&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s2">&quot;will-paginate-i18n&quot;</span><span class="p">,</span> <span class="s2">&quot;~&gt; 0.1.7&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>NOT: <code>gem</code> metodu gemi ekliyor ama kurmuyor. Yani biz gemleri ekledikten sonra <code>bundle install</code> metodunu çalıştırmalıyız.</p></blockquote>

<h4>gem_group(*names, &amp;block)</h4>

<p>Grup içerisine gem yazmamızı sağlar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">group</span> <span class="ss">:assets</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;bootstrap-sass&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;compass-rails&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;jquery-ui-rails&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>add_source(source, options = {})</h4>

<p>Gemler için source eklememizi sağlar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">add_source</span> <span class="s2">&quot;http://code.whytheluckystiff.net&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>initializer(filename, data = nil, &amp;block)</h4>

<p><code>config/initializers</code> klasörü altına  initializer dosyası eklememizi sağlar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">initializer</span> <span class="s1">&#39;resque_mailer.rb&#39;</span><span class="p">,</span> <span class="o">&lt;&lt;-</span><span class="no">CODE</span>
</span><span class='line'><span class="sh">class AsyncMailer &lt; ActionMailer::Base</span>
</span><span class='line'><span class="sh">  include Resque::Mailer</span>
</span><span class='line'><span class="sh">  layout &#39;email&#39;</span>
</span><span class='line'><span class="sh">end</span>
</span><span class='line'><span class="no">CODE</span>
</span></code></pre></td></tr></table></div></figure>


<h4>rakefile(filename, data = nil, &amp;block)</h4>

<p><code>lib/tasks</code> altına rake oluşturuyor</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rakefile</span><span class="p">(</span><span class="s2">&quot;bootstrap.rake&quot;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>  <span class="o">&lt;&lt;-</span><span class="no">TASK</span>
</span><span class='line'><span class="sh">    require &quot;resque/tasks&quot;</span>
</span><span class='line'><span class="sh">    task &quot;resque:setup&quot; =&gt; :environment</span>
</span><span class='line'><span class="no">  TASK</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>generate(what, args)</h4>

<p><code>generate</code> metodu <code>rails generator</code>&#8217; lerini çalıştırmamızı sağlıyor.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">generate</span><span class="p">(</span><span class="ss">:scaffold</span><span class="p">,</span> <span class="s2">&quot;person&quot;</span><span class="p">,</span> <span class="s2">&quot;name:string&quot;</span><span class="p">,</span> <span class="s2">&quot;address:text&quot;</span><span class="p">,</span> <span class="s2">&quot;age:number&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">generate</span> <span class="s1">&#39;simple_form:install --bootstrap&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>run(command, config={})</h4>

<p><code>run</code> metodu ismindende anlaşılcağı gibi sistem komutlarını çalıştırmaya yarıyor.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">run</span> <span class="s1">&#39;bundle install&#39;</span> <span class="c1"># bundle install komutunu çalıştırıyor</span>
</span><span class='line'><span class="n">run</span> <span class="s1">&#39;touch README.md&#39;</span> <span class="c1"># README.md isminde dosya oluturyor</span>
</span></code></pre></td></tr></table></div></figure>


<h4>rake(command, options = {})</h4>

<p><code>rake</code> çalıştırmamızı sağlıyor.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rake</span> <span class="s1">&#39;db:drop&#39;</span>
</span><span class='line'><span class="n">rake</span> <span class="s1">&#39;db:create&#39;</span>
</span><span class='line'><span class="n">rake</span> <span class="s1">&#39;db:migrate&#39;</span>
</span><span class='line'><span class="n">rake</span> <span class="s2">&quot;db:migrate&quot;</span><span class="p">,</span> <span class="ss">:env</span> <span class="o">=&gt;</span> <span class="s1">&#39;production&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>route(routing_code)</h4>

<p>Route <code>config/routes.rb</code> dosyasına routing entry eklememizi sağlar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">route</span> <span class="s2">&quot;root to: &#39;person#index&#39;&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>inside(dir)</h4>

<p>Klasör içerinde komut çalıştırmamıza yarar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;https://raw.github.com/lab2023/rails-template/master/files/&quot;</span>
</span><span class='line'><span class="n">inside</span> <span class="s1">&#39;app/views/devise&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">get</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;app/views/devise/confirmations/new.html.haml&#39;</span><span class="p">,</span> <span class="s1">&#39;confirmations/new.html.haml&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>ask(question)</h4>

<p>Kullanıcıdan bilgi alınmasını sağlar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">lib_name</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">&quot;What do you want to call the shiny library ?&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">lib_name</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;.rb&quot;</span> <span class="k">unless</span> <span class="n">lib_name</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;.rb&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">lib</span> <span class="n">lib_name</span><span class="p">,</span> <span class="o">&lt;&lt;-</span><span class="no">CODE</span>
</span><span class='line'><span class="sh">class Shiny</span>
</span><span class='line'><span class="sh">end</span>
</span><span class='line'><span class="no">CODE</span>
</span></code></pre></td></tr></table></div></figure>


<h4>yes?(question) or no?(question)</h4>

<p>Kullanıcya soru sormamızı sağlarlar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">if</span> <span class="n">yes?</span><span class="p">(</span><span class="s1">&#39;Would you like to use the Sphinx search system? (yes/no)&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">sphinx_flag</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>  <span class="n">sphinx_flag</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>git(:command)</h4>

<p>Git komutlarını kullanmamızı sağlıyor.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">git</span> <span class="ss">:init</span>
</span><span class='line'><span class="n">git</span> <span class="ss">:add</span> <span class="o">=&gt;</span> <span class="s1">&#39;.&#39;</span>
</span><span class='line'><span class="n">git</span> <span class="ss">:commit</span> <span class="o">=&gt;</span> <span class="s1">&#39;-m &quot;Issue #1 Install Rails &quot;&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>create_file(destination, data=nil, config={}, &amp;block)</h4>

<p><code>create_file</code> metodu yeni bir dosya oluşturur.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">create_file</span> <span class="s1">&#39;lib/tasks/resque.rake&#39;</span><span class="p">,</span> <span class="o">&lt;&lt;-</span><span class="no">CODE</span>
</span><span class='line'><span class="sh">require &quot;resque/tasks&quot;</span>
</span><span class='line'><span class="sh">task &quot;resque:setup&quot; =&gt; :environment</span>
</span><span class='line'><span class="no">CODE</span>
</span></code></pre></td></tr></table></div></figure>


<h4>gsub_file(path, flag, *args, &amp;block)</h4>

<p>Dosya içerisinde text değiştirmemizi sağlar. <code>flag</code> parametresi string ve regex bir ifade olabilir.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gsub_file</span> <span class="s1">&#39;config/application.rb&#39;</span><span class="p">,</span> <span class="sr">/:password/</span><span class="p">,</span> <span class="s1">&#39;:password, :password_confirmation&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>remove_file(path, config={})</h4>

<p>Dosya siler.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">remove_file</span> <span class="s1">&#39;app/models/user.rb&#39;</span>
</span><span class='line'><span class="n">remove_file</span> <span class="s1">&#39;app/models/admin.rb&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>inject_into_file(destination, *args, &amp;block)</h4>

<p>Dosya içerisine text eklememeizi sağlar. <code>:after</code> ve <code>:before</code> parametreleri ile nereye ekleme yapılacağını belirtebiliriz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">inject_into_file</span> <span class="s1">&#39;app/controllers/pages_controller.rb&#39;</span><span class="p">,</span> <span class="ss">:before</span> <span class="o">=&gt;</span> <span class="s1">&#39;end&#39;</span> <span class="k">do</span> <span class="o">&lt;&lt;-</span><span class="no">RUBY</span>
</span><span class='line'><span class="sh">skip_before_filter :authenticate_user!, :only =&gt; :index</span>
</span><span class='line'>
</span><span class='line'><span class="sh">def index</span>
</span><span class='line'>
</span><span class='line'><span class="sh">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="no">RUBY</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>append_file(path, *args, &amp;block)</h4>

<p>Dosyaya text eklememizi sağlar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">append_file</span> <span class="s1">&#39;.gitignore&#39;</span> <span class="k">do</span> <span class="o">&lt;&lt;-</span><span class="no">FILE</span>
</span><span class='line'><span class="sh">.idea</span>
</span><span class='line'><span class="sh">.idea/**/*</span>
</span><span class='line'><span class="no">FILE</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>get(source, destination=nil, config={}, &amp;block)</h4>

<p>Verilen adresteki içeriği alır ve hedef kaynağa yerleştirir. Yani hedef doyaya yazar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;https://raw.github.com/lab2023/rails-template/master/files/&quot;</span>
</span><span class='line'><span class="n">get</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;app/controllers/admins/application_controller.rb&#39;</span><span class="p">,</span> <span class="s1">&#39;app/controllers/admins/application_controller.rb&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Genel olarak sık kullandığımız metodları yazamaya çalıştım. Aşağıdaki linklerden daha fazla kaynağa ulşabilirsiniz. Dilerseniz <a href="https://github.com/lab2023/rails-template">lab2023 rails temaplate</a>&#8217; i inceleyebilrsiniz.</p>

<p>Kaynaklar:
http://guides.rubyonrails.org/rails_application_templates.html
https://github.com/wycats/thor/wiki/Actions
http://textmate.rubyforge.org/thor/Thor/Actions.html
http://rdoc.info/github/wycats/thor/master/Thor/Actions</p>

<p>İyi çalışmalar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Deploy İşlemleri Checklist'im]]></title>
    <link href="http://lab2023.github.com/blog/2012/12/20/deploy-islemleri-checklist-im/"/>
    <updated>2012-12-20T17:05:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2012/12/20/deploy-islemleri-checklist-im</id>
    <content type="html"><![CDATA[<p>Deploy ederken birşeyleri atlamamak için kendime bir checklist oluşturdum. Deploy için <a href="https://github.com/capistrano/capistrano">Capistrano</a> kullanıyoruz.</p>

<h3>Branch Merge işlemleri</h3>

<p><strong>Merge işlemlerini kesinlikle komut satırından yapın.</strong></p>

<ul>
<li>Merge edilecek branch taki tüm kodların güncel olduğundan emin olun.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">git</span> <span class="n">checkout</span> <span class="n">develop</span>
</span><span class='line'><span class="n">git</span> <span class="n">pull</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>Kodları test edin</p></li>
<li><p><strong>Üçüncü part <code>javascript</code>,  <code>css</code> dosyaları varmı bakın.</strong></p></li>
<li><p><strong>Varsa bunlar <code>environments/production.rb</code> ye eklenmişmi ona bakın. Assets precompile için.</strong></p></li>
<li><p>Kendisine merge yapılcak branch&#8217; taki kodların güncel olduğundan emin olun.</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
</span><span class='line'><span class="n">git</span> <span class="n">pull</span>
</span><span class='line'><span class="n">git</span> <span class="n">merge</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">ff</span> <span class="n">develop</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>config/deploy.rb</code> dosyasını kontrol edin. IP, user, port&#8230;</li>
</ul>


<!-- more -->


<h3>Deploy</h3>

<ul>
<li>Sunucuya bağlanıp veritabanı yedeği alınır. Ne olur ne olmaz.
MySQL için <a href="http://muhammetdilek.dudupress.com/articles/mysqldump-ile-veritabani-yedegi-alma">şu yazıyı</a> okuyabilirsiniz.  (Bunu otomatik yapan bir çalışma yapacağız)</li>
<li><code>cap deploy</code> komutu ile deploy edilir.</li>
<li>Migration var ise <code>cap deploy:migrate</code>komutu çalıştırılır.</li>
<li>Diğer cap task&#8217; lerine <code>cap --tasks</code>komutunu çalıştırarak bakabilirsiniz.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Muhammets</span><span class="o">-</span><span class="ss">iMac</span><span class="p">:</span><span class="n">dudupress</span> <span class="n">muhammetdilek</span><span class="err">$</span> <span class="n">cap</span> <span class="o">--</span><span class="n">tasks</span>
</span><span class='line'><span class="o">[</span><span class="no">Deprecation</span> <span class="no">Warning</span><span class="o">]</span> <span class="no">This</span> <span class="no">API</span> <span class="n">has</span> <span class="n">changed</span><span class="p">,</span> <span class="n">please</span> <span class="n">hook</span> <span class="sb">`deploy:create_symlink`</span> <span class="n">instead</span> <span class="n">of</span> <span class="sb">`deploy:symlink`</span><span class="o">.</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">bundle</span><span class="p">:</span><span class="n">install</span>                       <span class="c1"># Install the current Bundler enviro...</span>
</span><span class='line'><span class="n">cap</span> <span class="n">deploy</span>                               <span class="c1"># Deploys your project.</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">check</span>                         <span class="c1"># Test deployment dependencies.</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">check_revision</span>                <span class="c1"># Make sure local git is in sync wit...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">cleanup</span>                       <span class="c1"># Clean up old releases.</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">cold</span>                          <span class="c1"># Deploys and starts a `cold&#39; applic...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">create_symlink</span>                <span class="c1"># Updates the symlink to the most re...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">migrate</span>                       <span class="c1"># Run the migrate rake task.</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">migrations</span>                    <span class="c1"># Deploy and run pending migrations.</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">pending</span>                       <span class="c1"># Displays the commits since your la...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="ss">pending</span><span class="p">:</span><span class="n">diff</span>                  <span class="c1"># Displays the `diff&#39; since your las...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">resque_setup</span>                  <span class="c1"># Resque QUEUE Start</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">restart</span>                       <span class="c1"># restart unicorn server</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">rollback</span>                      <span class="c1"># Rolls back to a previous version a...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="ss">rollback</span><span class="p">:</span><span class="n">code</span>                 <span class="c1"># Rolls back to the previously deplo...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">setup</span>                         <span class="c1"># Prepares one or more servers for d...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">start</span>                         <span class="c1"># start unicorn server</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">stop</span>                          <span class="c1"># stop unicorn server</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">symlink</span>                       <span class="c1"># Deprecated API.</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">update</span>                        <span class="c1"># Copies your project and updates th...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">update_code</span>                   <span class="c1"># Copies your project to the remote ...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">update_crontab</span>                <span class="c1"># Update the crontab file</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">deploy</span><span class="p">:</span><span class="n">upload</span>                        <span class="c1"># Copy files to the currently deploy...</span>
</span><span class='line'><span class="n">cap</span> <span class="n">invoke</span>                               <span class="c1"># Invoke a single command on the rem...</span>
</span><span class='line'><span class="n">cap</span> <span class="n">shell</span>                                <span class="c1"># Begin an interactive Capistrano se...</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:configure</span>            <span class="c1"># Generate the Sphinx configuration ...</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:index</span>                <span class="c1"># Index data</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:install:sphinx</span>       <span class="c1"># If Postgres is available, Sphinx w...</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:install:ts</span>           <span class="c1"># Install Thinking Sphinx as a gem</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:rebuild</span>              <span class="c1"># Stop, re-index and then start the ...</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:restart</span>              <span class="c1"># Stop and then start the Sphinx daemon</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:shared_sphinx_folder</span> <span class="c1"># Add the shared folder for sphinx f...</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:start</span>                <span class="c1"># Start the Sphinx daemon</span>
</span><span class='line'><span class="n">cap</span> <span class="n">thinking_sphinx</span><span class="ss">:stop</span>                 <span class="c1"># Stop the Sphinx daemon</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">whenever</span><span class="p">:</span><span class="n">clear_crontab</span>               <span class="c1"># Clear application&#39;s crontab entrie...</span>
</span><span class='line'><span class="n">cap</span> <span class="ss">whenever</span><span class="p">:</span><span class="n">update_crontab</span>              <span class="c1"># Update application&#39;s crontab entri...</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Açıklamaları ile birlikte http://capitate.rubyforge.org/recipes/deploy.html</li>
<li>Deploydan sonra <code>cap deploy:restart</code> komutu ile unicorn restart edilir.</li>
<li>Test edilir.</li>
<li>Test sonucu başarılı ise bilgilendirme maili atılır.</li>
<li>Başarılı değilse başarılı olana kadar hotfix yapılır.</li>
</ul>


<h3>Hotfix</h3>

<ul>
<li>Hotfix branch oluştur</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="n">hotfix</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">1</span> <span class="n">master</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Hataları düzelt commit et</li>
<li>Master branch&#8217; a merge et</li>
<li>Sonra develop branch&#8217; a merge et</li>
<li>Sonra hotfix branch&#8217; ını sil</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">d</span> <span class="n">hotfix</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">1</span>
</span><span class='line'><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="ss">:hotfix</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>İyi çalışmalar dilerim&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Paperclip: Dosyaları  Yeni Bir Yol (Path)' a Taşımak]]></title>
    <link href="http://lab2023.github.com/blog/2012/12/19/paperclip-dosyalari-yeni-bir-yol-path-a-tasimak/"/>
    <updated>2012-12-19T17:08:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2012/12/19/paperclip-dosyalari-yeni-bir-yol-path-a-tasimak</id>
    <content type="html"><![CDATA[<p>Dosya upload işlemleri için genellikle <a href="https://github.com/thoughtbot/paperclip">Paperclip</a> kulanıyoruz.  Paperclipte <code>:path</code> parametresi ile dosyanın hangi path altına kaydedeliceğini belirtebiliyoruz. <code>Product</code> modelindeki <code>:picture</code> için bir path belirledik. Dosyalar <code>public/system/products/pictures/</code> dizinin altına <code>:style(original, icon, small, large)</code> klasörününde içine <code>"#{id}-#{name.parameterize}.format"</code> olarak kaydedilyor. Linklerde <code>http://localhost:3000/system/products/pictures/original/1-bilgisayar.jpeg</code> şeklinde oluyor. Peki biz bu path&#8217; i ürün production&#8217; a çıktıktan sonra değiştirirsek ne olur ?. Ne olacak tüm dosya linkleri patlayacak :) Yani eski dosyaları yeni path ile tekrar kaydettirmemiz gerekecek.</p>

<!-- more -->


<h3>Önce</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Product</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">has_attached_file</span> <span class="ss">:picture</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:default_url</span> <span class="o">=&gt;</span> <span class="s2">&quot;/assets/missing-image.jpg&quot;</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:styles</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>                        <span class="ss">:icon</span> <span class="o">=&gt;</span> <span class="s2">&quot;20x30#&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="ss">:small</span> <span class="o">=&gt;</span> <span class="s2">&quot;180x270#&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="ss">:large</span> <span class="o">=&gt;</span> <span class="s2">&quot;400x600#&quot;</span>
</span><span class='line'>                    <span class="p">},</span>
</span><span class='line'>                    <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s2">&quot;public/system/:class/:attachment/:style/:sef_file_name.:extension&quot;</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:url</span> <span class="o">=&gt;</span> <span class="s2">&quot;/system/:class/:attachment/:style/:sef_file_name.:extension&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">Paperclip</span><span class="o">.</span><span class="n">interpolates</span> <span class="ss">:sef_file_name</span> <span class="k">do</span> <span class="o">|</span><span class="n">attachment</span><span class="p">,</span> <span class="n">style</span><span class="o">|</span>
</span><span class='line'>    <span class="n">attachment</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">sef_file_name</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">sef_file_name</span>
</span><span class='line'>    <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="nb">name</span><span class="o">.</span><span class="n">parameterize</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Sonra</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Product</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">has_attached_file</span> <span class="ss">:picture</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:default_url</span> <span class="o">=&gt;</span> <span class="s2">&quot;/assets/missing-image.jpg&quot;</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:styles</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>                        <span class="ss">:icon</span> <span class="o">=&gt;</span> <span class="s2">&quot;20x30#&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="ss">:small</span> <span class="o">=&gt;</span> <span class="s2">&quot;180x270#&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="ss">:large</span> <span class="o">=&gt;</span> <span class="s2">&quot;400x600#&quot;</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<blockquote><p>Dosyalar için bir <code>:path</code> belirtmezsek <code>paperclip</code> dosyaları default path ile kaydediyor.</p></blockquote>

<p>Resimler şimdi <code>public/system/products/pictures/000/:id/:style</code> şeklinde kaydediliyor.  Şimdi eski doyaları bu path altına yeniden kaydedelim. Bunun için kısa bir rake yazacağız.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">namespace</span> <span class="ss">:picture_path</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">desc</span> <span class="s2">&quot;product picture&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:product</span> <span class="o">=&gt;</span> <span class="ss">:environment</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">products</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;picture_file_name IS NOT NULL&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">products</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span>
</span><span class='line'>      <span class="n">filename</span> <span class="o">=</span> <span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="s1">&#39;pictures&#39;</span><span class="p">,</span> <span class="s1">&#39;original&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">p</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="nb">p</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">parameterize</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="nb">p</span><span class="o">.</span><span class="n">picture_file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="no">File</span><span class="o">.</span><span class="n">exists?</span> <span class="n">filename</span>
</span><span class='line'>        <span class="n">image</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span> <span class="n">filename</span>
</span><span class='line'>        <span class="nb">p</span><span class="o">.</span><span class="n">picture</span> <span class="o">=</span> <span class="n">image</span>
</span><span class='line'>        <span class="nb">p</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>        <span class="n">image</span><span class="o">.</span><span class="n">close</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>filename</code>&#8217; e eski yolu atıyoruz. Eğer böyle bir yol var ise dosyayı yeniden kaydediyoruz. Kaydedilen dosyada yeni path ile kaydediliyor. Eski dosyalar hala duruyor ama.</p>

<p>Son olarakta Rake&#8217; i çalıştıralım</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake picture_path:product
</span></code></pre></td></tr></table></div></figure>


<p>İyi çalışmalar dilerim</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby On Rails' te Ransack Gem' i ile Arama]]></title>
    <link href="http://lab2023.github.com/blog/2012/12/16/ruby-on-rails-te-ransack-gem-i-ile-arama/"/>
    <updated>2012-12-16T17:19:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2012/12/16/ruby-on-rails-te-ransack-gem-i-ile-arama</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/ernie/ransack/"><code>Ransack</code></a> ile kolay bir şekilde arama ve sıralama işlemlerini yapabiliyoruz. <code>Gemfile</code> dosyasına</p>

<p><code>gem 'ransack'</code> satırını ekledikten sonra <code>bundle install</code> ile kuralım.</p>

<p>Arama için <code>search</code> metodunu kullanıyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;&gt;</span> <span class="no">Product</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="ss">:name_cont</span> <span class="o">=&gt;</span> <span class="s2">&quot;aaaa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_sql</span>
</span><span class='line'><span class="s2">&quot;SELECT `products`.* FROM `products`  WHERE (`products`.`name` LIKE &#39;%aaaa%&#39;)&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Aynı anda iki alanda arama yapmak istersek <code>or</code> kullanıyoruz.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;&gt;</span> <span class="no">Product</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="ss">:name_or_barcode_cont</span> <span class="o">=&gt;</span> <span class="s2">&quot;aaaa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_sql</span>
</span><span class='line'><span class="s2">&quot;SELECT `products`.* FROM `products`  WHERE ((`products`.`name` LIKE &#39;%aaaa%&#39; OR `products`.`barcode` LIKE &#39;%aaaa%&#39;))&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<h3>İlişkişli Kayıtlarda Arama Yapmak</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># product.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Product</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:brand</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">has_and_belongs_to_many</span> <span class="ss">:keywords</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:custom_products</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;&gt;</span> <span class="no">Product</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="ss">:name_or_barcode_or_keywords_name_cont</span> <span class="o">=&gt;</span> <span class="s2">&quot;aaaa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_sql</span>
</span><span class='line'><span class="s2">&quot;SELECT `products`.* FROM `products` LEFT OUTER JOIN `keywords_products` ON `keywords_products`.`product_id` = `products`.`id` LEFT OUTER JOIN `keywords` ON `keywords`.`id` = `keywords_products`.`keyword_id` WHERE (((`products`.`name` LIKE &#39;%aaaa%&#39; OR `products`.`barcode` LIKE &#39;%aaaa%&#39;) OR `keywords`.`name` LIKE &#39;%aaaa%&#39;))&quot;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;&gt;</span> <span class="no">Product</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="ss">:name_or_barcode_or_brand_name_cont</span> <span class="o">=&gt;</span> <span class="s2">&quot;aaaa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_sql</span>
</span><span class='line'><span class="s2">&quot;SELECT `products`.* FROM `products` LEFT OUTER JOIN `brands` ON `brands`.`id` = `products`.`brand_id` WHERE (((`products`.`name` LIKE &#39;%aaaa%&#39; OR `products`.`barcode` LIKE &#39;%aaaa%&#39;) OR `brands`.`name` LIKE &#39;%aaaa%&#39;))&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Tamamda bu sondaki <code>cont</code> ne işe yarıyor ? diye sorular duyar gibi oluyorum. <code>cont</code> <code>Ransack</code> eylemlerinden birisi. Yani nasıl arama yapacağını belirtiyoruz. İçerisinde aaaa geçsin, aaaa ile başlayanler vs. vs. <code>cont</code> içerisinde aaaa geçen kayıtları getiriyor. Diğer <code>Ransack</code> eylemlerini şu linkten incleyebilrsiniz. https://github.com/ernie/ransack/wiki/Basic-Searching</p>

<h3>Controller</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>  <span class="vi">@search</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:q</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="vi">@products</span> <span class="o">=</span> <span class="vi">@search</span><span class="o">.</span><span class="n">result</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Arama için varsayılan parametre <code>:q</code>. İstersek değiştirebiliyoruz. https://github.com/ernie/ransack/wiki/Configuration</li>
<li>Eğer aram sonuçlarında tekrar eden kayıt istemiyorsak(<code>DISTINCT</code>) <code>:distrinct =&gt; true</code> parametresini geçiyoruz.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>  <span class="vi">@search</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:q</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="vi">@products</span> <span class="o">=</span> <span class="vi">@search</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="ss">:distinct</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>View</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="p">=</span> <span class="n">search_form_for</span> <span class="vi">@search</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
</span><span class='line'>  <span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name_cont</span>
</span><span class='line'>  <span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">submit</span> <span class="s2">&quot;Search&quot;</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;btn&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Sıralama</h3>

<p><code>sort_link</code> helper metodunu kullanıyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#product.html.haml</span>
</span><span class='line'><span class="o">%</span><span class="n">table</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">table</span><span class="o">-</span><span class="n">striped</span><span class="o">.</span><span class="n">table</span><span class="o">-</span><span class="n">bordered</span><span class="o">.</span><span class="n">table</span><span class="o">-</span><span class="n">condensed</span>
</span><span class='line'>  <span class="o">%</span><span class="n">tr</span>
</span><span class='line'>    <span class="o">%</span><span class="n">th</span><span class="o">=</span> <span class="n">sort_link</span><span class="p">(</span><span class="vi">@search</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="s2">&quot;İsim&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="o">%</span><span class="n">th</span><span class="o">=</span> <span class="n">sort_link</span><span class="p">(</span><span class="vi">@search</span><span class="p">,</span> <span class="ss">:barcode</span><span class="p">,</span> <span class="s2">&quot;Barkod&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="o">%</span><span class="n">th</span><span class="o">=</span> <span class="n">sort_link</span><span class="p">(</span><span class="vi">@search</span><span class="p">,</span> <span class="ss">:sub_category_name</span><span class="p">,</span> <span class="s2">&quot;Kategori&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">-</span> <span class="vi">@products</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">product</span><span class="o">|</span>
</span><span class='line'>    <span class="o">%</span><span class="n">tr</span>
</span><span class='line'>      <span class="o">%</span><span class="n">td</span><span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'>      <span class="o">%</span><span class="n">td</span><span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">barcode</span>
</span><span class='line'>      <span class="o">%</span><span class="n">td</span><span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">sub_category</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:name</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="https://dl.dropbox.com/u/44821222/Screen%20Shot%202012-12-16%20at%206.01.31%20PM.png" alt="product" /></p>

<p><img src="https://dl.dropbox.com/u/44821222/Screen%20Shot%202012-12-16%20at%206.01.49%20PM.png" alt="product" /></p>

<p>İyi çalışmalar dilerim.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby on Rails'te Excel Export]]></title>
    <link href="http://lab2023.github.com/blog/2012/12/07/ruby-on-rails-te-excel-export/"/>
    <updated>2012-12-07T17:21:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2012/12/07/ruby-on-rails-te-excel-export</id>
    <content type="html"><![CDATA[<p>Excel export işlemlerinde <a href="https://github.com/splendeo/to_xls"><code>to_xls</code></a> gemini kullanıyoruz. Export edilen excel dosyaları <code>xls</code> uzantısında oluyor.</p>

<p>Excel renderlermek için <code>config/initializers/mime_types.rb</code> doyasına mime type eklemeyi unutmuyalım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">Mime</span><span class="p">:</span><span class="ss">:Type</span><span class="o">.</span><span class="n">register</span> <span class="s2">&quot;application/vnd.ms-excel&quot;</span><span class="p">,</span> <span class="ss">:xls</span>
</span></code></pre></td></tr></table></div></figure>


<p>Gemfile dosyasına <code>gem 'to_xls'</code> ekleyip <code>bundle install</code> ile kuruyoruz.</p>

<!-- more -->


<h3>Kullanımı</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">UserController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@users</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">all</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">html</span>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">xml</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:xml</span> <span class="o">=&gt;</span> <span class="vi">@users</span> <span class="p">}</span>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">xls</span> <span class="p">{</span> <span class="n">send_data</span> <span class="vi">@users</span><span class="o">.</span><span class="n">to_xls</span><span class="p">,</span> <span class="ss">:filename</span> <span class="o">=&gt;</span> <span class="s1">&#39;users.xls&#39;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>@users</code> koleksiyonu içindeki ilk itemin propertilerine göre <code>@users</code> koleksiyonunu export eder. Properti ismileri kolon başlığı olarak kabul edilir.</p>

<p>Eğer kolonlara başlık vermek istemiyorsak <code>:headers =&gt; false</code> parametresini geçiyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@users</span><span class="o">.</span><span class="n">to_xls</span><span class="p">(</span><span class="ss">:headers</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Sheet ismini belirtmek istiyorsak <code>:name =&gt; "Users"</code> parametresini geçiyoruz. Varsayılanı Sheet1</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@users</span><span class="o">.</span><span class="n">to_xls</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">&quot;Users&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Propertilerin hepsini değilde seçtiklerimizi export etmek istersek <code>:columns</code> parametresi ile bunu belirtebilyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@users</span><span class="o">.</span><span class="n">to_xls</span><span class="p">(</span><span class="ss">:columns</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:role</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Bu kolonların isimlerini değiştirmek istersek <code>:headers</code> parametresini kullanıyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@users</span><span class="o">.</span><span class="n">to_xls</span><span class="p">(</span><span class="ss">:columns</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:role</span><span class="o">]</span><span class="p">,</span> <span class="ss">:headers</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s1">&#39;İsim&#39;</span><span class="p">,</span> <span class="s1">&#39;Rol&#39;</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Peki ilişkili kayıtlarıda export edebiliyor muyuz ? Evet ilişkili kayıtlarıda export edebiliyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@users</span><span class="o">.</span><span class="n">to_xls</span><span class="p">(</span><span class="ss">:columns</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:name</span><span class="p">,</span> <span class="p">{</span><span class="ss">:company</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:address</span><span class="o">]</span><span class="p">}</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>company</code> modelindeki <code>:name</code> ve <code>:address</code> propertilerini aldık.</p>

<p>Böyle export edince kolon isimlerini company_name , company_address şeklinde oluşturacaktır. Kolon isimlerini değiştirmek için yine <code>:headers</code> parametresini kullanabiliriz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@users</span><span class="o">.</span><span class="n">to_xls</span><span class="p">(</span><span class="ss">:columns</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:name</span><span class="p">,</span> <span class="p">{</span><span class="ss">:company</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:address</span><span class="o">]</span><span class="p">}</span><span class="o">]</span><span class="p">,</span> <span class="ss">:headers</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;Address&#39;</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>İyi çalışmalar dilerim&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby On Rails REST API'de Access Token Kullanarak Kullanıcı Doğrulama]]></title>
    <link href="http://lab2023.github.com/blog/2012/11/27/ruby-on-rails-rest-api-de-access-token-kullanarak-kullanici-dogrulama/"/>
    <updated>2012-11-27T17:23:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2012/11/27/ruby-on-rails-rest-api-de-access-token-kullanarak-kullanici-dogrulama</id>
    <content type="html"><![CDATA[<p>Öncelikle;</p>

<ul>
<li><p><code>HTTPS</code> kullanın. Çünkü <code>HTTP</code> kullanıldığında  parametreler plain text olarak iletiliyor. <code>Http Request</code>&#8217; leri dinleyen birisi keylerinize çok rahat ulaşabilir.</p></li>
<li><p><code>access_token</code>&#8217; ları url den parametre olarak almak yerine <code>Http Header</code>&#8217; dan almak daha uygundur. Çünkü kullanıcı alışkanlıkları  (kopyala-yapıştır-test et) yönündedir. URL de unutulan tokenlar güvenlik için tehlikeli olabilir.</p></li>
</ul>


<p>Kullanıcı doğrulama ile ilgili daha önce yazdığım <a href="http://muhammetdilek.dudupress.com/articles/ruby-on-rails-rest-api-de-http-basic-authentication-kullanarak-kullanici-dogrulama">Ruby On Rails REST API&#8217; de HTTP Basic Authentication Kullanarak Kullanıcı Doğrulama
</a> yazısını okuyabilirsiniz.</p>

<!-- more -->


<p><code>API</code>&#8217; de güvenliği sağlamanın diğer bir yolu ise <code>API</code>&#8217; yi kullanacak client&#8217; lara bir <code>API_KEY</code> verip o <code>API_KEY</code> ile authenticate yapmak. Bu yöntemi kullanırsak <code>API_KEY</code> leri saklamak için bir modele ihtiyacımız olacak.
Bu modelde;</p>

<ul>
<li><code>user_id</code></li>
<li><code>access_token</code></li>
<li><code>expires_at</code>
alanlarını tutacağız. Eğer <code>API_KEY</code> ömrünü kısıtlamak istemiyorsanız <code>expires_at</code> alanına ihtiyacınız yok.</li>
</ul>


<p>Ben burada örneği kısa tutmak için <code>user_id</code> ve <code>expires_at</code> alanlarını kullanmayacağım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>rails g model api_key access_token:string
</span><span class='line'>      invoke  active_record
</span><span class='line'>      create    db/migrate/20121006130334_create_api_keys.rb
</span><span class='line'>      create    app/models/api_key.rb
</span><span class='line'>      invoke    test_unit
</span><span class='line'>      create      <span class="nb">test</span>/unit/api_key_test.rb
</span><span class='line'>      create      <span class="nb">test</span>/fixtures/api_keys.yml
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ApiKey</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">before_create</span> <span class="ss">:generate_access_token</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">generate_access_token</span>
</span><span class='line'>    <span class="k">begin</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="no">SecureRandom</span><span class="o">.</span><span class="n">hex</span>
</span><span class='line'>    <span class="k">end</span> <span class="k">while</span> <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">exists?</span><span class="p">(</span><span class="n">access_token</span><span class="p">:</span> <span class="n">access_token</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Burada <code>access_token</code> üretmek için <code>ruby 1.9</code>&#8217; la gelen <code>SecureRandom.hex</code> metodunu kullanarak 16 haneden oluşan <code>string</code> bir <code>access_token</code> oluşturuyoruz. Eğer oluşturulan bu <code>access_token</code> daha önceden oluşturulmuş ise kod daha önceden oluşturulmayan bir <code>access_token</code> üretinceye kadar tekrar çalışıyor.</p>

<p>Şimdi bir ApiKey oluşturup devam edelim.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>rails c
</span><span class='line'>Loading development environment <span class="o">(</span>Rails 3.2.8<span class="o">)</span>
</span><span class='line'>1.9.3p194 :001 &gt; ApiKey.create
</span><span class='line'>   <span class="o">(</span>0.0ms<span class="o">)</span>  begin transaction
</span><span class='line'>  ApiKey Exists <span class="o">(</span>0.1ms<span class="o">)</span>  SELECT 1 AS one FROM <span class="s2">&quot;api_keys&quot;</span> WHERE <span class="s2">&quot;api_keys&quot;</span>.<span class="s2">&quot;access_token&quot;</span> <span class="o">=</span> <span class="s1">&#39;765582c8bf829e682abe70618957a42a&#39;</span> LIMIT 1
</span><span class='line'>Binary data inserted <span class="k">for</span> <span class="sb">`</span>string<span class="sb">`</span> <span class="nb">type </span>on column <span class="sb">`</span>access_token<span class="sb">`</span>
</span><span class='line'>  SQL <span class="o">(</span>35.5ms<span class="o">)</span>  INSERT INTO <span class="s2">&quot;api_keys&quot;</span> <span class="o">(</span><span class="s2">&quot;access_token&quot;</span>, <span class="s2">&quot;created_at&quot;</span>, <span class="s2">&quot;updated_at&quot;</span><span class="o">)</span> VALUES <span class="o">(</span>?, ?, ?<span class="o">)</span>  <span class="o">[[</span><span class="s2">&quot;access_token&quot;</span>, <span class="s2">&quot;765582c8bf829e682abe70618957a42a&quot;</span><span class="o">]</span>, <span class="o">[</span><span class="s2">&quot;created_at&quot;</span>, Sat, 06 Oct 2012 13:11:59 UTC +00:00<span class="o">]</span>, <span class="o">[</span><span class="s2">&quot;updated_at&quot;</span>, Sat, 06 Oct 2012 13:11:59 UTC +00:00<span class="o">]]</span>
</span><span class='line'>   <span class="o">(</span>2.0ms<span class="o">)</span>  commit <span class="nv">transaction</span>
</span><span class='line'> <span class="o">=</span>&gt; <span class="c">#&lt;ApiKey id: 1, access_token: &quot;765582c8bf829e682abe70618957a42a&quot;, created_at: &quot;2012-10-06 13:11:59&quot;, updated_at: &quot;2012-10-06 13:11:59&quot;&gt; </span>
</span><span class='line'>1.9.3p194 :002 &gt;
</span></code></pre></td></tr></table></div></figure>


<p><code>Controller</code>&#8217; a <code>access_token</code> kontrolü yapan bir metod yazacağız;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">module</span> <span class="nn">Api</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">V2</span>
</span><span class='line'>    <span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>      <span class="kp">include</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:MimeResponds</span>
</span><span class='line'>      <span class="kp">include</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:HttpAuthentication</span><span class="o">::</span><span class="ss">Basic</span><span class="p">:</span><span class="ss">:ControllerMethods</span>
</span><span class='line'>      <span class="c1">#http_basic_authenticate_with name: &#39;admin&#39;, password: &#39;secret&#39;</span>
</span><span class='line'>      <span class="n">before_filter</span> <span class="ss">:restrict_access</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">respond_to</span> <span class="ss">:json</span><span class="p">,</span> <span class="ss">:xml</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">#Actions</span>
</span><span class='line'>
</span><span class='line'>      <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">def</span> <span class="nf">restrict_access</span>
</span><span class='line'>        <span class="n">api_key</span> <span class="o">=</span> <span class="no">ApiKey</span><span class="o">.</span><span class="n">find_by_access_token</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:access_token</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>        <span class="n">head</span> <span class="ss">:unauthorized</span> <span class="k">unless</span> <span class="n">api_key</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>http://pigon.dev/api/products</code> adresini açtığımızda bize hiçbir datanın dönmediğini görüyoruz. Birde query olarak <code>access_token</code> ekleyerek bakalım;
<img src="https://dl.dropbox.com/u/44821222/access-token.png" alt="API_KEY" />
Evet gördüğünüz gibi urlden <code>acces_token</code> alarak datalara erişim kısıtlaması getirebiliyoruz. <code>access_token</code>&#8217; bilgilisini <code>URL</code>&#8217; den almak yerine <code>HTTP Header</code> dan alalım.</p>

<p><code>Rails</code>&#8217; te <code>HTTP header</code>&#8217; dan <code>access_token</code> almak için <code>authenticate_or_request_with_http_token</code> metodunu kullancağız.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">restrict_access</span>
</span><span class='line'>  <span class="c1">#api_key = ApiKey.find_by_access_token(params[:access_token])</span>
</span><span class='line'>  <span class="c1">#head :unauthorized unless api_key</span>
</span><span class='line'>  <span class="n">authenticate_or_request_with_http_token</span> <span class="k">do</span> <span class="o">|</span><span class="n">token</span><span class="p">,</span> <span class="n">options</span><span class="o">|</span>
</span><span class='line'>    <span class="no">ApiKey</span><span class="o">.</span><span class="n">exists?</span><span class="p">(</span><span class="n">access_token</span><span class="p">:</span> <span class="n">token</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Eğer <a href="https://github.com/rails-api/rails-api"><code>Rails::API</code></a> gem&#8217; ini kullanıyorsak <code>ActionController::HttpAuthentication::Token::ControllerMethods</code> modülünü <code>Controller</code>&#8217; a eklememiz gerekiyor.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>curl http://pigon.dev/api/products -H <span class="s1">&#39;Authorization: Token token=&quot;xyz&quot;&#39;</span>
</span><span class='line'>HTTP Token: Access denied.
</span><span class='line'>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>curl http://pigon.dev/api/products -H <span class="s1">&#39;Authorization: Token token=&quot;765582c8bf829e682abe70618957a42a&quot;&#39;</span>
</span><span class='line'><span class="o">[{</span><span class="s2">&quot;amount&quot;</span>:<span class="s2">&quot;4.3&quot;</span>,<span class="s2">&quot;created_at&quot;</span>:<span class="s2">&quot;2012-10-06T09:58:47Z&quot;</span>,<span class="s2">&quot;id&quot;</span>:2,<span class="s2">&quot;title&quot;</span>:<span class="s2">&quot;Product2&quot;</span>,<span class="s2">&quot;updated_at&quot;</span>:<span class="s2">&quot;2012-10-06T09:58:47Z&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;amount&quot;</span>:<span class="s2">&quot;15.0&quot;</span>,<span class="s2">&quot;created_at&quot;</span>:<span class="s2">&quot;2012-10-06T09:59:14Z&quot;</span>,<span class="s2">&quot;id&quot;</span>:3,<span class="s2">&quot;title&quot;</span>:<span class="s2">&quot;Product3Update&quot;</span>,<span class="s2">&quot;updated_at&quot;</span>:<span class="s2">&quot;2012-10-06T09:59:24Z&quot;</span><span class="o">}]</span>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<p>Komut satırından baktığımızda kodlarımızın çalıştığını görüyoruz.</p>

<p>İyi çalışmalar.</p>

<p>Kaynak: <a href="http://railscasts.com/episodes/352-securing-an-api">RailsCasts</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby On Rails ile Rails::API Gem'ini Kullanarak API Geliştirme]]></title>
    <link href="http://lab2023.github.com/blog/2012/11/24/ruby-on-rails-ile-rails-api-gem-ini-kullanarak-api-gelistirme/"/>
    <updated>2012-11-24T17:25:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2012/11/24/ruby-on-rails-ile-rails-api-gem-ini-kullanarak-api-gelistirme</id>
    <content type="html"><![CDATA[<p>Daha önce API geliştirme ile ilgili <a href="http://www.gelistiricigunlugu.com/ruby-on-rails-te-api-yazalim/">Ruby On Rails’ te API Yazalım</a> başlıklı bir yazı yazmıştım. Bu yazımda ise <code>Rails::API</code> gem&#8217; ini kullanarak <code>API</code> geliştirmeyi anlatacağım.</p>

<p><code>Rails::API</code> bir <code>API</code> için gerekli olan kütüphaneler dışındaki kütüphaneleri çıkararak(view, assests &#8230;), normal bir rails projesine göre daha hafif bir proje oluşturabilmemizi sağlayan gem.</p>

<p>Aşağıdaki komutu çalıştırarak gem&#8217; i yükleyelim</p>

<p><code>gem install rails-api</code></p>

<!-- more -->


<p>Yeni proje oluşturmak için aşağıdaki komutu kullanacağız.</p>

<p><code>rails-api new pigon</code></p>

<p>Komutu çalışıtrdıktan sonra projenin dosyalarına baktığımızda <code>app</code> dizininin çok sade olduğunu görüyoruz. API geliştirme ihtiyacı dışındaki şeyler(views, helpers, assets) atılmıştır. <code>ApplicationController</code>&#8217; a baktığımızda <code>ActionController::Base</code> yerine daha hafif olan <code>ActionController::API</code>&#8217; den türetildiğini görüyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:API</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>En büyük değişiklik ise <code>Gemfile</code> dosyamızda. <code>rails-api</code> gem&#8217; ini buraya eklenmiş olarak görüyoruz fakat <code>assets</code> grubundaki gem&#8217; lerin ve <code>jquery-rails</code> gem&#8217; inin eklenmediğini görüyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">source</span> <span class="s1">&#39;https://rubygems.org&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;rails&#39;</span><span class="p">,</span> <span class="s1">&#39;3.2.8&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Bundle edge Rails instead:</span>
</span><span class='line'><span class="c1"># gem &#39;rails&#39;, :git =&gt; &#39;git://github.com/rails/rails.git&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;rails-api&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;sqlite3&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Peki generator&#8217; larda nasıl bir değişiklik oluyor?. <code>scaffold</code> ile <code>Product</code> modeli oluşturduğumuzda <code>assets</code>, <code>views</code> ve <code>helpers</code> dosyalarının oluşturulmadığını görüyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>rails g scaffold Product title:string price:decimal
</span><span class='line'>      invoke  active_record
</span><span class='line'>      create    db/migrate/20121003130313_create_products.rb
</span><span class='line'>      create    app/models/product.rb
</span><span class='line'>      invoke    test_unit
</span><span class='line'>      create      <span class="nb">test</span>/unit/product_test.rb
</span><span class='line'>      create      <span class="nb">test</span>/fixtures/products.yml
</span><span class='line'>      invoke  api_resource_route
</span><span class='line'>       route    resources :products, except: :edit
</span><span class='line'>      invoke  scaffold_controller
</span><span class='line'>      create    app/controllers/products_controller.rb
</span><span class='line'>      invoke    test_unit
</span><span class='line'>      create      <span class="nb">test</span>/functional/products_controller_test.rb
</span></code></pre></td></tr></table></div></figure>


<p>Gördüğünüz gibi <code>model</code>, <code>controller</code> ve <code>test</code> dosyalarından oluşan bir yapı oluşturuldu. Şimdi migration&#8217; ı çalıştıralım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>rake db:migrate
</span></code></pre></td></tr></table></div></figure>


<p><code>scaffold</code> tarafından generate edilen <code>ProductsController</code>&#8217; ına baktığımızda sadece <code>JSON</code>formatında veri döndürüldüğünü göreceksiniz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="c1"># GET /products</span>
</span><span class='line'>  <span class="c1"># GET /products.json</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@products</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">all</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@products</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># GET /products/1</span>
</span><span class='line'>  <span class="c1"># GET /products/1.json</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show</span>
</span><span class='line'>    <span class="vi">@product</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@product</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># GET /products/new</span>
</span><span class='line'>  <span class="c1"># GET /products/new.json</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">new</span>
</span><span class='line'>    <span class="vi">@product</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@product</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># POST /products</span>
</span><span class='line'>  <span class="c1"># POST /products.json</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create</span>
</span><span class='line'>    <span class="vi">@product</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:product</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="vi">@product</span><span class="o">.</span><span class="n">save</span>
</span><span class='line'>      <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@product</span><span class="p">,</span> <span class="ss">status</span><span class="p">:</span> <span class="ss">:created</span><span class="p">,</span> <span class="ss">location</span><span class="p">:</span> <span class="vi">@product</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@product</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="ss">status</span><span class="p">:</span> <span class="ss">:unprocessable_entity</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># PATCH/PUT /products/1</span>
</span><span class='line'>  <span class="c1"># PATCH/PUT /products/1.json</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">update</span>
</span><span class='line'>    <span class="vi">@product</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="vi">@product</span><span class="o">.</span><span class="n">update_attributes</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:product</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>      <span class="n">head</span> <span class="ss">:no_content</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@product</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="ss">status</span><span class="p">:</span> <span class="ss">:unprocessable_entity</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># DELETE /products/1</span>
</span><span class='line'>  <span class="c1"># DELETE /products/1.json</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">destroy</span>
</span><span class='line'>    <span class="vi">@product</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@product</span><span class="o">.</span><span class="n">destroy</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">head</span> <span class="ss">:no_content</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Uygulamamızın hiç <code>HTML</code> view renderlemediğini sadece <code>JSON</code> renderlediğini görüyoruz. Tarayıcımızda <code>/products</code> yolunu ziyaret ettiğimizde <code>JSON</code> formatında henüz ürün eklemediğimiz için boş bir <code>array</code> renderlediğini göreceğiz.</p>

<p><code>curl</code> ile uygulamamıza product ekleyelim.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Muhammets-iMac:pigon muhammetdilek<span class="nv">$ </span>curl -d <span class="s2">&quot;product[title]=Product1&amp;product[price]=3.3&quot;</span> http://pigon.dev/products
</span><span class='line'><span class="o">{</span><span class="s2">&quot;created_at&quot;</span>:<span class="s2">&quot;2012-10-03T13:27:10Z&quot;</span>,<span class="s2">&quot;id&quot;</span>:3,<span class="s2">&quot;price&quot;</span>:<span class="s2">&quot;3.3&quot;</span>,<span class="s2">&quot;title&quot;</span>:<span class="s2">&quot;Product1&quot;</span>,<span class="s2">&quot;updated_at&quot;</span>:<span class="s2">&quot;2012-10-03T13:27:10Z&quot;</span><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>/products</code> adresini ziyeret ettiğimizde</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">[</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="err">created_at:</span> <span class="nt">&quot;2012-10-03T13:28:27Z&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="err">id:</span> <span class="err">1,</span>
</span><span class='line'>        <span class="err">price:</span> <span class="nt">&quot;3.3&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="err">title:</span> <span class="nt">&quot;Product1&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="err">updated_at:</span> <span class="nt">&quot;2012-10-03T13:28:27Z&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>JSON</code> formatında eklediğimiz ürünü görüyoruz.</p>

<p>Şimdide uygulamamıza <code>XML</code> desteği ekleyelim.</p>

<p>Burada <code>respond_to</code> metodunu kullanacağız.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@products</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">all</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@products</span> <span class="p">}</span>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">xml</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">xml</span><span class="p">:</span> <span class="vi">@products</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>/products.xml</code> sayfasını ziyaret ettiğimizde aşağıdaki hatayı alacağız.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>NoMethodError in ProductsController#index
</span><span class='line'>
</span><span class='line'>undefined method <span class="sb">`</span>respond_to<span class="err">&#39;</span> <span class="k">for</span> <span class="c">#&lt;ProductsController:0x007fbc096e1438&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Rails::API</code> de uygulamayı daha hafif hale getirmek için bir dizi özellik çıkarılmış durumda ama biz istersek bu özellikleri kolayca uygulamalarımza geri ekleyebiliriz. Yukarıdaki aldığımız hata da <code>ActionController::MimeResponds</code> modülü etkin olmadığından kaynaklanıyor. <code>ProductController</code>&#8217; a <code>ActionController::MimeResponds</code> modülünü ekleyelim.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="kp">include</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:MimeResponds</span>
</span><span class='line'>  <span class="c1">#Actions</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="https://dl.dropbox.com/u/44821222/xml-response.png" alt="xml response" /></p>

<p><code>Rails::API</code> README dosyasında ihtiyacımız çerçevesinde hangi <a href="https://github.com/spastorino/rails-api/blob/master/README.md">modulleri</a> kullanabilecegimiz listelenmiştir. Ancak bu liste modüllerin tam listesi değil. <code>Rails</code> <a href="https://github.com/rails/rails/blob/master/actionpack/lib/action_controller/base.rb#L201">kodları</a> ile <code>Rails::API</code>nin <a href="https://github.com/spastorino/rails-api/blob/master/lib/rails-api/action_controller/api.rb#L124">kodlarını</a> karşılaştırdığımızda bu listedeki eksik olanları görebiliyoruz.</p>

<p>Bazı modülleri kullanmak istediğimizde  modülü sadece controller&#8217; da çağırmak yetmeyebibilir. <code>Rails::API</code> <code>Controller</code>&#8217; ları azalttığı gibi aynı zamanda <code>Rack middleware</code> katmanınıda azaltmıştır. Normal bir rails uygulamasındaki middleware&#8217; lar ile <code>Rails::API</code> gem&#8217; ini kullanarak olulturduğumuz bir uygulamadaki middleware&#8217; ları karşılaştırırsak aşağıdaki middleware&#8217; ların çıkarılmış olduğunu görüyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>use Rack::MethodOverride
</span><span class='line'>use ActionDispatch::Cookies
</span><span class='line'>use ActionDispatch::Session::CookieStore
</span><span class='line'>use ActionDispatch::Flash
</span><span class='line'>use ActionDispatch::BestStandardsSupport
</span></code></pre></td></tr></table></div></figure>


<p>İhtiyacımız çerçevesinde bu middleware&#8217; ları <code>application.rb</code> ye ekleyerek kullanabiliriz.</p>

<p><code>Rails::API</code> kullanırken karşılaşılan sorunların birçoğu issuelarda çözülmüş. https://github.com/rails-api/rails-api/issues?page=1&amp;state=closed   Gözatmakta fayda var.</p>

<p>İyi çalışmalar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[scp - Sunucuya Dosya Gönderip Alma]]></title>
    <link href="http://lab2023.github.com/blog/2012/11/01/scp-sunucuya-dosya-gonderip-alma/"/>
    <updated>2012-11-01T13:06:00+02:00</updated>
    <id>http://lab2023.github.com/blog/2012/11/01/scp-sunucuya-dosya-gonderip-alma</id>
    <content type="html"><![CDATA[<p>Merhabalar,</p>

<p><code>scp</code> komutunu kullanarak;</p>

<ul>
<li>Uzak bilgisayar (Sunucu) ile yerel bilgisayar (Locale) arasında</li>
<li>Uzak bilgisayar ile uzak bilgisayar arasında</li>
</ul>


<p>dosya kopyalama işlemlerini yapabilyoruz.</p>

<!-- more -->


<h4>Yerel bilgisayardan den uzak bilgisayara dosya kopyalamak için;</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>scp ~/Dropbox/pigonws/_20120731_2255.sql deployer@10.1.2.3:~/apps/backups
</span></code></pre></td></tr></table></div></figure>


<p>Burada;</p>

<ul>
<li><p><code>~/Dropbox/pigonws/_20120731_2255.sql</code> : Yerel bilgisayardaki dosyanın yolu.</p></li>
<li><p><code>deployer@10.1.2.3:~/apps/backups</code> : kullanıcı @ sunucu ip si : sunucudaki yol.</p></li>
</ul>


<p>Komutu çalıştırdıktan sonra ssh ile uzak bilgisayara bağlanıp  yerel bilgisayardaki <code>_20120731_2255.sql</code> dosyasını uzak bilgisayardaki <code>~/apps/backups</code> dizininin altına kopyalıyoruz.</p>

<h4>Uzak bilgisayardan yerel bilgisayara dosya almak için;</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>scp deployer@10.1.2.3:~/apps/backups/pigon_production.sql ~/Dropbox/pigonws/
</span></code></pre></td></tr></table></div></figure>


<h4>Uzak bilgisayardan uzak bilgisayara dosya kopyalamak için;</h4>

<p>Açıkçası bunu hiç denemedim. Şuradaki linkten http://askubuntu.com/questions/153960/scp-with-two-different-ports bakabilrsiniz.</p>

<h3>Parametreler</h3>

<ul>
<li><code>-P</code> : SSH portunu belirtme.</li>
<li><code>-q</code> : Progress barı gösterme.</li>
<li><code>-r</code> : Klasör kopyalayacaksak.</li>
<li><code>-v</code> : Debug mesajlarını göster.</li>
</ul>


<p>İyi çalışmalar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MySQL root şifresini resetleme]]></title>
    <link href="http://lab2023.github.com/blog/2012/10/23/mysql-root-sifresini-resetleme/"/>
    <updated>2012-10-23T15:22:00+03:00</updated>
    <id>http://lab2023.github.com/blog/2012/10/23/mysql-root-sifresini-resetleme</id>
    <content type="html"><![CDATA[<p><code>root</code> şifreside unutulurmu demeyin valla unutuluyor :)</p>

<ul>
<li><code>MySQL</code> server durdulur</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>service mysql stop
</span><span class='line'><span class="c"># veya</span>
</span><span class='line'><span class="nv">$ </span>sudo /etc/init.d/mysql stop
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>--skip-grant-tables</code> parametresi ile güvenli modda tekrar başlatalım. Güvenli modda başlatınca yetkilerin hiçbirisi dikkate alınmayacak.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo mysqld_safe --skip-grant-tables
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>MySQL</code> konsoluna giriş yapalım</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>mysql -u root
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>root</code> şifresini değiştirelim</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mysql&gt; use mysql;
</span><span class='line'>mysql&gt; update user <span class="nb">set </span><span class="nv">password</span><span class="o">=</span>PASSWORD<span class="o">(</span><span class="s2">&quot;NEWPASSWORD&quot;</span><span class="o">)</span> where <span class="nv">User</span><span class="o">=</span><span class="s1">&#39;root&#39;</span>;
</span><span class='line'>mysql&gt; flush privileges;
</span><span class='line'>mysql&gt; quit
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>MySQL</code> sunucusunu başlatalım</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>service mysql start
</span></code></pre></td></tr></table></div></figure>


<p>İyi çalışmalar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MySQL'de yeni veritabanı ve veritabanı kullancısı oluşturma]]></title>
    <link href="http://lab2023.github.com/blog/2012/10/23/mysqlde-yeni-veritabani-ve-veritabani-kullancisi-olusturma/"/>
    <updated>2012-10-23T13:04:00+03:00</updated>
    <id>http://lab2023.github.com/blog/2012/10/23/mysqlde-yeni-veritabani-ve-veritabani-kullancisi-olusturma</id>
    <content type="html"><![CDATA[<ul>
<li><code>MySQL</code>&#8217; e login olalım</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>mysql -u root -p
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Veritabanı oluşturalım</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='mysql'><span class='line'><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">pigon_production</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>pigon_production</code> isminde bir veritabanı oluşturduk.</p>

<ul>
<li>Şimdide bir kullanıcı oluşturalım ve <code>pigon_production</code>&#8217; ı kullanabilmesi için yetki verelim.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='mysql'><span class='line'><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">ON</span> <span class="n">pigon_production</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;pigon&#39;</span><span class="o">@</span><span class="n">localhost</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;pigon_password&#39;</span><span class="p">;</span>
</span><span class='line'><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">FLUSH</span> <span class="n">PRIVILEGES</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Artık <code>pigon</code> kullanıcısı oluşturuldu ve <code>pigon_production</code> veritabanını kullanma yetkisi verildi. Buradaki yetki <code>GRANT ALL</code> komutundan da anlaşılacağı gibi veritabanı üzerinde tüm işlemleri yapabilme yetkisidir.</p>

<p>Kolaylıklar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sunucunun ssh portunu değiştirme]]></title>
    <link href="http://lab2023.github.com/blog/2012/10/22/sunucunun-ssh-portunu-degistirme/"/>
    <updated>2012-10-22T15:14:00+03:00</updated>
    <id>http://lab2023.github.com/blog/2012/10/22/sunucunun-ssh-portunu-degistirme</id>
    <content type="html"><![CDATA[<p><code>ssh</code> portu default olarak 22 dir. Güvenlik için istersek bunu değiştirebiliyoruz.</p>

<p><code>nano</code> ile <code>/etc/ssh/</code> dizinindeki <code>sshd_config</code> dosyasını açıp 5. satırdaki <code>Port 22</code> yazan yerdeki <code>22</code> portunu değiştirip kaydediyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo nano /etc/ssh/sshd_config
</span></code></pre></td></tr></table></div></figure>


<p>Değişiklikler algılaması için aşağıdaki komut ile <code>ssh</code>&#8217; ı yeniden başlatıyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo /etc/init.d/ssh restart
</span></code></pre></td></tr></table></div></figure>


<p>Localden bağlanırken portu belirtiyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>ssh root@x.x.x.x -p 9387
</span></code></pre></td></tr></table></div></figure>


<p>-p parametresi ile portu belirtmiş olduk.</p>

<p>Eğer deploy işlemleri için <code>Capistrano</code> kullanıyorsak <code>deploy.rb</code> dosyasında aşağıdaki gibi portu belirtiyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">set</span> <span class="ss">:port</span><span class="p">,</span> <span class="mi">30000</span>
</span></code></pre></td></tr></table></div></figure>


<p>İyi çalışmalar</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mysql'de kullanıcı şifrelerini değiştirme]]></title>
    <link href="http://lab2023.github.com/blog/2012/10/22/mysql-de-kullanici-sifrelerini-degistirme/"/>
    <updated>2012-10-22T15:10:00+03:00</updated>
    <id>http://lab2023.github.com/blog/2012/10/22/mysql-de-kullanici-sifrelerini-degistirme</id>
    <content type="html"><![CDATA[<p>MySQL şifre değiştirme işlemleri için kullandığım iki yöntem var. Onlardan bahsedeceğim.</p>

<h3><code>mysqladmin</code> komutunu kullanarak</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>mysqladmin -u root -pcurrentpassword password <span class="s1">&#39;newpassword&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>-p<strong>currentpassword</strong> teki <code>p</code> ile <code>currentpassword</code> bitişik. Bu alana şimdiki şifremizi <code>newpassword</code> alanınan da yeni şifremizi yazıyoruz.</p></blockquote>

<!-- more -->


<h3><code>UPDATE</code> sql komutunu kullanarak</h3>

<p>1) <strong>Mysql server&#8217; a login olalım;</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>mysql -u root -p
</span></code></pre></td></tr></table></div></figure>


<p>2) <strong>mysql database&#8217; ini seçelim;</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mysql&gt; use mysql;
</span></code></pre></td></tr></table></div></figure>


<p>3) <strong>Aşağıdaki sql komutuyla şifreyi değiştiriyoruz;</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mysql&gt; update user <span class="nb">set </span><span class="nv">password</span><span class="o">=</span>PASSWORD<span class="o">(</span><span class="s2">&quot;NEWPASSWORD&quot;</span><span class="o">)</span> where <span class="nv">User</span><span class="o">=</span><span class="s1">&#39;root&#39;</span>;
</span></code></pre></td></tr></table></div></figure>


<p>4) <strong>Yetkileri yenileyelim;</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mysql&gt; flush privileges;
</span><span class='line'>mysql&gt; quit
</span></code></pre></td></tr></table></div></figure>


<blockquote><p><strong>NOT: <code>MySQL</code> kullancı bilgileri <code>mysql</code> database&#8217; inde tutulmaktadır. Step2 de <code>mysql</code> database&#8217; ini seçerek işlemlere devam ettik.</strong></p></blockquote>

<p>İyi çalışmalar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ubuntu makine üzerinde kullanıcı şifrelerini değiştirme]]></title>
    <link href="http://lab2023.github.com/blog/2012/10/22/ubuntu-makine-uzerinde-kullanici-sifrelerini-degistirme/"/>
    <updated>2012-10-22T15:08:00+03:00</updated>
    <id>http://lab2023.github.com/blog/2012/10/22/ubuntu-makine-uzerinde-kullanici-sifrelerini-degistirme</id>
    <content type="html"><![CDATA[<p><code>root</code> olarak oturum açtıktan sonra;</p>

<ul>
<li><code>passwd</code> komutunu çalıştırarak root şifresini</li>
<li><code>passwd username</code> komutunu çalıştırarak diğer kullanıcların şifrelerini değiştirebiliriz.</li>
</ul>


<p>Kolaylıklar&#8230;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[mysqldump ile veritabanı yedeği alma]]></title>
    <link href="http://lab2023.github.com/blog/2012/10/22/mysqldump-ile-veritabani-yedegi-alma/"/>
    <updated>2012-10-22T15:07:00+03:00</updated>
    <id>http://lab2023.github.com/blog/2012/10/22/mysqldump-ile-veritabani-yedegi-alma</id>
    <content type="html"><![CDATA[<p>Bugün sunucu üzerinde işlemler yaparken ne olur olmaz deyip mysql yedeğini alayım dedim. Aşağıdaki komut satırı ile veritabanı yedeğini alabiliyormuşuz.</p>

<p><code>mysqldump -u username -p database&gt; backup_20121022.sql</code></p>

<p><code>mysql</code> şifresini girdikten sonra bulunduğumuz dizine <code>backup_20121022.sql</code> isminde bir dosyaya veritabanı yedeğini alıyor.</p>

<p>İyi çalışmalar.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby On Rails'te Client Side Validasyon]]></title>
    <link href="http://lab2023.github.com/blog/2012/10/12/ruby-on-rails-te-client-side-validasyon/"/>
    <updated>2012-10-12T15:00:00+03:00</updated>
    <id>http://lab2023.github.com/blog/2012/10/12/ruby-on-rails-te-client-side-validasyon</id>
    <content type="html"><![CDATA[<p>Client Side validasyonlar için <a href="https://github.com/bcardarella/client_side_validations">ClientSideValidations</a> gemini kullanıyoruz. <code>Simple Form</code> ile çalışabilmesi içinde <a href="https://github.com/dockyard/client_side_validations-simple_form">ClientSideValidationsSimpleForm</a> gemini kullanıyoruz.</p>

<h3>Kurulum</h3>

<p>Gemleri <code>Gemfile</code>&#8217; a ekleyip <code>bundle install</code> yapalım</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;client_side_validations&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;client_side_validations-simple_form&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Daha sonra kurulum komutunu çalştıralım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">client_side_validations</span><span class="ss">:install</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>config/initializers/client_side_validations.rb</code> başlangıç dosyasının eklendiğini görüyoruz.</p>

<p>Eğer istersek gem&#8217; lerin kullandığı javascript dosyaların assets dizinin altına kopyalayabiliriz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">client_side_validations</span><span class="ss">:copy_assets</span>
</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<h3>Kullanım</h3>

<p><code>app/assets/javascripts/application.js</code> dosyasında gerekli dosyaları çağıralım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">//= require rails.validations</span>
</span><span class='line'><span class="c1">//= require rails.validations.simple_form</span>
</span></code></pre></td></tr></table></div></figure>


<p>Forma <code>:validate =&gt; true</code> parametresini geçiyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="p">=</span> <span class="n">simple_form_for</span><span class="p">(</span><span class="vi">@product</span><span class="p">,</span> <span class="ss">:validate</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
</span><span class='line'>  <span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">error_notification</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.form-inputs</span>
</span><span class='line'>    <span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">input</span> <span class="ss">:title</span>
</span><span class='line'>    <span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">input</span> <span class="ss">:price</span>
</span><span class='line'>    <span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">input</span> <span class="ss">:status</span>
</span><span class='line'>
</span><span class='line'>  <span class="nc">.form-actions</span>
</span><span class='line'>    <span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">button</span> <span class="ss">:submit</span>
</span></code></pre></td></tr></table></div></figure>


<p>Şimdide modele gidip validasyonları yazalım.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Product</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">attr_accessible</span> <span class="ss">:price</span><span class="p">,</span> <span class="ss">:status</span><span class="p">,</span> <span class="ss">:title</span>
</span><span class='line'>  <span class="n">validates_presence_of</span> <span class="ss">:price</span><span class="p">,</span> <span class="ss">:title</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">validates_length_of</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">:minimum</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="ss">:maximum</span> <span class="o">=&gt;</span> <span class="mi">10</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">validates_numericality_of</span> <span class="ss">:price</span><span class="p">,</span> <span class="ss">:greater_than</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="p">,</span> <span class="ss">:less_than</span> <span class="o">=&gt;</span> <span class="mi">100</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">validates_uniqueness_of</span> <span class="ss">:title</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>İstersek validasyonları form içinde tek bir input&#8217; a da ekleyebiliyoruz.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="p">=</span> <span class="n">f</span><span class="o">.</span><span class="n">input</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">:validate</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:presence</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="https://dl.dropbox.com/u/44821222/validation.png" alt="validates_presence_of" />
<img src="https://dl.dropbox.com/u/44821222/validation-two.png" alt="validates_numericality_of" />
<img src="https://dl.dropbox.com/u/44821222/uniqueness1.png" alt="validates_uniqueness_of" /></p>

<p>Son ekran görüntüsünde dikkat ettiyseniz ajax ile uniq olup olmadığını bile kontrol edebiliyor.</p>

<p>En kısa sürede <a href="http://www.lab2023.com">lab2023</a> bünyesinde <code>open-source</code> olarak geliştirdiğimiz  <a href="https://github.com/lab2023/rails-template">Rails Template</a>&#8217; e ekleyeceğiz. <a href="https://github.com/lab2023/rails-template/issues/30">Issue</a>&#8217; yu girdim bile :)</p>

<p>İyi çalışmalar dilerim.</p>
]]></content>
  </entry>
  
</feed>
